## [파이썬] 판다스
1. 판다스란?
   - 판다스란, 데이터 조작, 정제, 분석, 시각화 등을 위한 다양한 기능을 제공하는 파이썬 데이터 분석 라이브러리 입니다.

1.1. 판다스 데이터 객체

1.1.1. 데이터 프레임 객체:
- 행과 열로 이루어진 **2차원 데이터**를 다루기 위한 객체입니다. 열은 각각의 변수를 나타내고, 행은 각각의 관측치를 나타냅니다. 데이터 프레임 객체는 여러 가지 방법으로 생성할 수 있습니다.


```python
# 판다스 라이브러리 호출
import pandas  as pd
```

#####  리스트를 사용하여 데이터 프레임 객체를 생성하기


```python
data = [['윈터','에스파'],['장원영','아이브'],['예지','잇지']]
df= pd.DataFrame(data,columns=['가수명','그룹'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>가수명</th>
      <th>그룹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>윈터</td>
      <td>에스파</td>
    </tr>
    <tr>
      <th>1</th>
      <td>장원영</td>
      <td>아이브</td>
    </tr>
    <tr>
      <th>2</th>
      <td>예지</td>
      <td>잇지</td>
    </tr>
  </tbody>
</table>
</div>



길이가 2인 내부 리스트를 3개 가지고 있는 리스트를 생성하고,
이를 데이터 프레임화 시키고 columns 명을 가수명, 그룹으로 할당하고 **데이터 프레임화** 하였습니다.

#####  딕셔너리를 사용하여 데이터 프레임 객체를 생성하기


```python
data2 = {'한식' :['닭도리탕','감자탕','비빔밥'], '일식':['초밥','돈까스','카이센동']}
df2= pd.DataFrame(data2)
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>한식</th>
      <th>일식</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>닭도리탕</td>
      <td>초밥</td>
    </tr>
    <tr>
      <th>1</th>
      <td>감자탕</td>
      <td>돈까스</td>
    </tr>
    <tr>
      <th>2</th>
      <td>비빔밥</td>
      <td>카이센동</td>
    </tr>
  </tbody>
</table>
</div>



딕셔너리를 통해, 데이터 프레임화를 하면, 자동으로  key 값은 컬럼명, values 값은 데이터 프레임의 셀요소로 변환됩니다.

##### pd.read_csv, pd.read_excel 을 이용해 외부 인자를 데이터 프레임화 하기


```python
import os
os.getcwd() #get current directoy: 현재 작업 공간을 탐색
```




    'C:\\Users\\zuise'




```python
iris=pd.read_csv('iris.csv')
```


```python
iris
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div>



세부적인 메소드 들을 알아 보겠습니다.

#### 파일 불러올 때, index 지정해 주기: index_col
만일, 인덱스 열을 별도로 시정하고 싶다면, index_col 값에 컬럼명 혹은 컬럼의 위치 열을 지정하면 됩니다.


```python
iris2=pd.read_csv('iris.csv',index_col='variety')
```


```python
iris2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
    </tr>
    <tr>
      <th>variety</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Setosa</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div>



### read_csv,excel 의 인자들

- header = 외부 데이터를 불러올때, 그 데이터 내에서 칼럼 이름의 역할을 할 행을 지정해주는 인자입니다.
    - header= None 이면 칼럼명이 없다는 뜻이고, 이럴 때에는 names: 에 배열 형태로 칼럼명을 사용자가 직접 입력할 수 있습니다.
- encoding= 외부 파일의 인코딩이 맞지 않으면 UnicodeDecodeError 가 발생하는데, 이때  encoding= 인자에 코덱을 입력해 오류를 피할 수 있습니다.
- 특정 줄을 생략하는 파라미터:
    skiprows=[x,x]
- 결측값 규정 옵션: na_values -> 불러 오려는 데이터 셋에서 결측치를 규정하는 문자나 단어들을 na_values 안에 입력하면, 자동으로 결측치로 인식하게 됩니다.
- dtyp= 컬럼들의 데이터 유형을 컬럼명: 데이터 타입 의 형태로 딕셔너리화 해서 입력하면, 데이터의 유형을 설정하고 데이터를 추출할 수 있게 됩니다.


```python
iris3=pd.read_csv('iris.csv',skiprows=[0,2])
```


```python
iris3 #0, 2줄을 생략하고 출력
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>5.1</th>
      <th>3.5</th>
      <th>1.4</th>
      <th>.2</th>
      <th>Setosa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.4</td>
      <td>3.9</td>
      <td>1.7</td>
      <td>0.4</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.6</td>
      <td>3.4</td>
      <td>1.4</td>
      <td>0.3</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>143</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>144</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Virginica</td>
    </tr>
  </tbody>
</table>
<p>148 rows × 5 columns</p>
</div>



n개의 행만 불러오고 싶을 때, nrow=n


```python
iris2=pd.read_csv('iris.csv',nrows=3)
```


```python
iris2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
  </tbody>
</table>
</div>



이는 iris2.head(3) 과 유사한데, 위의 방식은 외부에서 데이터를 불러오는 시점에서부터  개수를 정하고, head의 경우 모든 데이터를 불러오고 그중에서 3개를 불러온다는 차이점이 있습니다.

1.1.2. Series 객체

인덱스와 값으로 이루어진 1차원 데이터를 다루기 위한 객체입니다. 이 series 객체는 데이터 프레임 객체에서 열과 행을 추출해서도 만들 수 있습니다.


```python
data=['python','R','java','c++']
lan= pd.Series(data,index=[0,1,2,3])
lan
```




    0    python
    1         R
    2      java
    3       c++
    dtype: object




```python
dicta={0:'파이썬',1:'알',2:'자바',3:'c'}
gua=pd.Series(dicta)
gua
```




    0    파이썬
    1      알
    2     자바
    3      c
    dtype: object



2. Pandas 데이터 프레임 메소드

df 라는 빈 데이터 프레임을 만들어 보겠습니다.


```python
df= pd.DataFrame()
```

데이터 프레임을 먼저 정의하고, 이 데이터 프레임에 칼럼과 행들을 입력하는 방법으로도 데이터 프레임을 만들 수 있습니다.


```python
df['국어 성적']=[34,78,65,56,92,100,21]
#국어 성적이라는 컬럼안의 데이터들을 삽입.
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>78</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>92</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>



2.1 데이터의 구조를 보는 메서드
 - info()
 - describe()
 - head()
 - tail()

info 메서드는 데이터 프레임 내 셀의 데이터 정보를 출력합니다.


```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 7 entries, 0 to 6
    Data columns (total 1 columns):
     #   Column  Non-Null Count  Dtype
    ---  ------  --------------  -----
     0   국어 성적   7 non-null      int64
    dtypes: int64(1)
    memory usage: 188.0 bytes
    

- 데이터 프레임의 크기: 188 바이트. 
- 데이터의 타입: 정수형 결측치: 0개( 실측치:7개)

head(),tail() :인자= 시각화를 원하는 데이터의 개수
* 파라미터란? : 함수나 메서드에 전달되는 값을 의미합니다. 함수 또는 메서드가 호출 될 때 전달된 값에 대응합니다.
* 인자란? : 함수를 호출 시 전달되는 값을 의미합니다.


```python
df.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>78</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.tail(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>92</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>



위에서 보는 것과 같이, head 의 경우 위에서 아래로 인자 값만큼, tail 의 경우 아래에서 위로 인자 값만큼만 데이터를 보여줍니다.

## 기초 통계량 메서드: describe()
- describe() 메소드는 메우 중요한 메소드로, 요약 통계량을 시각화해 보여줍니다.
- 내부의 count, mean, min. max 와 같은 함수는 df.max(), min(), std() 와 같은 방법으로 접근이 가능합니다.


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>63.714286</td>
    </tr>
    <tr>
      <th>std</th>
      <td>29.124527</td>
    </tr>
    <tr>
      <th>min</th>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>65.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>85.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div>



+사분위수 접근 메소드: quantile
0,25,50,75,100퍼센트에 위치한 값들을 데이터 프레임으로 반환합니다.


```python
quantile=df.quantile([0,0.25,0.5,0.75,1]) 
quantile
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.00</th>
      <td>21.0</td>
    </tr>
    <tr>
      <th>0.25</th>
      <td>45.0</td>
    </tr>
    <tr>
      <th>0.50</th>
      <td>65.0</td>
    </tr>
    <tr>
      <th>0.75</th>
      <td>85.0</td>
    </tr>
    <tr>
      <th>1.00</th>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div>



## 2.1 데이터 프레임 내부 접근 메서드


```python
data = [['윈터','에스파'],['장원영','아이브'],['예지','잇지']]
df= pd.DataFrame(data,columns=['가수명','그룹'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>가수명</th>
      <th>그룹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>윈터</td>
      <td>에스파</td>
    </tr>
    <tr>
      <th>1</th>
      <td>장원영</td>
      <td>아이브</td>
    </tr>
    <tr>
      <th>2</th>
      <td>예지</td>
      <td>잇지</td>
    </tr>
  </tbody>
</table>
</div>



### 2.1.1 [], loc, iloc : 데이터 프레임의 행, 열의 접근하는 방법

데이터 프레임도 리스트, 딕셔너리와 비슷하게 인덱싱이 가능합니다. 다음은 중괄호를 이용해 df 의 리스트에 접근해 보았습니다.


```python
df['가수명']
```




    0     윈터
    1    장원영
    2     예지
    Name: 가수명, dtype: object



loc 메서드: loc[ 행,'열 이름']

위의 데이터에서 예지를 검색하고 싶다면 어떻게 해야 할까요?
'예지' 는 2행. 가수명 열에 위치하고 있는 데이터 입니다.


```python
df.loc[2,'가수명']
```




    '예지'



iloc 의 경우, loc 와 유사하지면 여기서는 컬럼명이 아니라 인덱스 번호로만 접근해야 합니다.


```python
df.iloc[2,0]
```




    '예지'




```python
df['나이']=[23,19,23]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>가수명</th>
      <th>그룹</th>
      <th>나이</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>윈터</td>
      <td>에스파</td>
      <td>23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>장원영</td>
      <td>아이브</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>예지</td>
      <td>잇지</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>



아래처럼 ':' 를 입력하게 되면, 행 혹은 열을 모두 loc 하겠다는 의미로 인식됩니다. 다음은 '나이' 열의 모든 데이터를 조회하는 과정입니다.


```python
df.loc[:,'나이']
```




    0    23
    1    19
    2    23
    Name: 나이, dtype: int64




```python
df.loc[2,:] #2행의 데이터를 모두 출력하는 경우
```




    가수명    예지
    그룹     잇지
    나이     23
    Name: 2, dtype: object



시작 인덱스의 시작 포인트: 종료 인덱스 +1 을 입력하게 되면
그 구간사이의 모든 행렬 데이터를 반환합니다.


```python
df.iloc[:,0:2] 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>가수명</th>
      <th>그룹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>윈터</td>
      <td>에스파</td>
    </tr>
    <tr>
      <th>1</th>
      <td>장원영</td>
      <td>아이브</td>
    </tr>
    <tr>
      <th>2</th>
      <td>예지</td>
      <td>잇지</td>
    </tr>
  </tbody>
</table>
</div>



### 2.1.2 쿼리를 통한 데이터 추출법

- 조건에 부합하는 데이터를 추출할 때에, query 함수를 사용하는데, 이 메서드의 장점, 단점 은 다음과 같습니다.
    - 가독성과 편의성이 좋습니다.
    - loc,[] 보다 속도가 느립니다.

#### Query 의 기능들
1. 비교 연산자의 기능 (==.>,!= 등)
2. in 연산자 (값이 내부에 있는지를)
3. 논리 연산자 (and or not)
4. 외부 변수를 참조한 연산
5. 인덱스 검색
6. 문자열 부분 검색


```python
import numpy as np # 랜덤화난수 생성을 위해 작성
data = {
    "age":list(np.random.randint(10,30,size=20)),
    "height":list(np.random.randint(160,190,size=20)),
}
df= pd.DataFrame(data)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18</td>
      <td>161</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>181</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27</td>
      <td>165</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>167</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>182</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13</td>
      <td>167</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15</td>
      <td>161</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>168</td>
    </tr>
    <tr>
      <th>8</th>
      <td>22</td>
      <td>189</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>179</td>
    </tr>
    <tr>
      <th>10</th>
      <td>25</td>
      <td>181</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10</td>
      <td>168</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>184</td>
    </tr>
    <tr>
      <th>13</th>
      <td>21</td>
      <td>171</td>
    </tr>
    <tr>
      <th>14</th>
      <td>21</td>
      <td>187</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>172</td>
    </tr>
    <tr>
      <th>16</th>
      <td>12</td>
      <td>160</td>
    </tr>
    <tr>
      <th>17</th>
      <td>23</td>
      <td>182</td>
    </tr>
    <tr>
      <th>18</th>
      <td>16</td>
      <td>187</td>
    </tr>
    <tr>
      <th>19</th>
      <td>22</td>
      <td>165</td>
    </tr>
  </tbody>
</table>
</div>



1. 비교 연산자


```python
eps1= "age<20" #셀렉트 문장의 where 랑 비슷
df_q1=df.query(eps1)
df_q1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18</td>
      <td>161</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>181</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13</td>
      <td>167</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15</td>
      <td>161</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>179</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10</td>
      <td>168</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>184</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>172</td>
    </tr>
    <tr>
      <th>16</th>
      <td>12</td>
      <td>160</td>
    </tr>
    <tr>
      <th>18</th>
      <td>16</td>
      <td>187</td>
    </tr>
  </tbody>
</table>
</div>



and,or 를 사용해 조건을 2개 이상 부여 할수 있습니다.


```python
eps2 = "age<20 and height>=170"
df_q2=df.query(eps2)
df_q2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>181</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>179</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>184</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>172</td>
    </tr>
    <tr>
      <th>18</th>
      <td>16</td>
      <td>187</td>
    </tr>
  </tbody>
</table>
</div>



sql 의 select 쿼리를 사용하는 것과같이 직관적으로 접근할 수 있습니다. 

2. in 연산자의 활용

만들어진 df_q2 라는 데이터에서 나이가 15살이 있는지를 보겠습니다.


```python
eps3= "age in [15]"
df_q3= df.query(eps3)
df_q3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>15</td>
      <td>161</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>172</td>
    </tr>
  </tbody>
</table>
</div>




```python
#만약에 16살이 있는지를 알고 싶다면,
#in 은 리스트 값이 하나라도 잇으면 참을 반환합니다.
eps4 = "age in [11]"
df_q0= df.query(eps4)
df_q0
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



3. 외부 변수 참조 연산

f 스트링 또는 @ 를 통해 외부 변수를 잠조할 수 있습니다.


```python
mean= df['height'].mean()
q_50= df['age'].quantile(0.5)
print(mean)
print(q_50)
#참조할 외부 변수를 만들었습니다.
```

    173.85
    19.0
    


```python
expr4 =f'(age>{q_50}) and (height<={mean})'
df_q4= df.query(expr4)
df_q4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>27</td>
      <td>165</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>167</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>168</td>
    </tr>
    <tr>
      <th>13</th>
      <td>21</td>
      <td>171</td>
    </tr>
    <tr>
      <th>19</th>
      <td>22</td>
      <td>165</td>
    </tr>
  </tbody>
</table>
</div>




```python
expr4_5 ='(age>@q_50) and (height<=@mean)'
df.query(expr4_5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>27</td>
      <td>165</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>167</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>168</td>
    </tr>
    <tr>
      <th>13</th>
      <td>21</td>
      <td>171</td>
    </tr>
    <tr>
      <th>19</th>
      <td>22</td>
      <td>165</td>
    </tr>
  </tbody>
</table>
</div>



4.문자열 데이터를 검색하는 기능을 가지고 있습니다. str.contains(비교할 문자열),startswith,endswith..

2.1.2 value_counts(), shape, len


```python
data = [['윈터','에스파'],['장원영','아이브'],['예지','잇지']]
df= pd.DataFrame(data,columns=['가수명','그룹'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>가수명</th>
      <th>그룹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>윈터</td>
      <td>에스파</td>
    </tr>
    <tr>
      <th>1</th>
      <td>장원영</td>
      <td>아이브</td>
    </tr>
    <tr>
      <th>2</th>
      <td>예지</td>
      <td>잇지</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['가수명'].value_counts()
```




    가수명
    윈터     1
    장원영    1
    예지     1
    Name: count, dtype: int64




```python
df.shape #데이트의 행, 열 을 반환합니다.
```




    (3, 2)




```python
len(df)  #데이터의 행의 개수만을 반환합니다.
```




    3




```python
df.nunique() # 데이터의 프레임 열의 중복된 값을 제외한 개수를 반환합니다.
```




    가수명    3
    그룹     3
    dtype: int64



#### 2.1.3. 4행렬 데이터 삭제, 칼럼명 변경 메서드


```python
datas= {'이름' : ['harry','lone','herm'],'class':[1,2,3],
'grade':[78,86,94]}
datas
```




    {'이름': ['harry', 'lone', 'herm'], 'class': [1, 2, 3], 'grade': [78, 86, 94]}




```python
potters=pd.DataFrame(datas)
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>class</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
      <td>94</td>
    </tr>
  </tbody>
</table>
</div>



행 추가 메서드-> by loc


```python
potters.loc[3]=['말포이',4,73]
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>class</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
      <td>94</td>
    </tr>
    <tr>
      <th>3</th>
      <td>말포이</td>
      <td>4</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div>



행렬 내의 데이터를 변경하거나, 수정하는 것은 위의 loc, iloc 메서드를 사용해 해당 셀을 찾고, 거기에 새로운 값을 할당하는 방식으로 수정이 가능합니다.


```python
potters.iloc[3,0]='malpoi' #3행 0열의 말포이를 탐색
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>class</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
      <td>94</td>
    </tr>
    <tr>
      <th>3</th>
      <td>malpoi</td>
      <td>4</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div>



열이름 변경 메소드: rename
- 데이터 프레임.rename(columns={'변경칼럼':'변경할 이름'}, inplace=True -> 이 부분은 값을 할당하지 않고 바로 적용하겠다는 뜻임
- '이름' 을 name 으로 변경해 보도록 하겠습니다.


```python
potters.rename(columns={'이름':'name'},inplace=True)
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>class</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
      <td>94</td>
    </tr>
    <tr>
      <th>3</th>
      <td>malpoi</td>
      <td>4</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div>



### 2.1.3. filter() 메서드
함수를 정규표현식 을 이용해 더 디테일하게 필터링 하는 메서드 입니다.


```python
ff=pd.DataFrame()
ff['age']= list(np.random.randint(15,30,size=20))
ff['height']= list(np.random.randint(160,190,size=20))
ff['name']=['alpha','beta','three','four','go','roku'
           ,'seven','eigt','toka','eleven','twelve','j_3',
           'j_4','15','sixteen','teen_7','teen_8','adult','james','20']
```


```python
ff
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>169</td>
      <td>alpha</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>181</td>
      <td>beta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26</td>
      <td>186</td>
      <td>three</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>174</td>
      <td>four</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>172</td>
      <td>go</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16</td>
      <td>168</td>
      <td>roku</td>
    </tr>
    <tr>
      <th>6</th>
      <td>28</td>
      <td>164</td>
      <td>seven</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>167</td>
      <td>eigt</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>171</td>
      <td>toka</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29</td>
      <td>161</td>
      <td>eleven</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23</td>
      <td>176</td>
      <td>twelve</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>162</td>
      <td>j_3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>15</td>
      <td>182</td>
      <td>j_4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>19</td>
      <td>178</td>
      <td>15</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>167</td>
      <td>sixteen</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>163</td>
      <td>teen_7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>28</td>
      <td>186</td>
      <td>teen_8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>176</td>
      <td>adult</td>
    </tr>
    <tr>
      <th>18</th>
      <td>15</td>
      <td>187</td>
      <td>james</td>
    </tr>
    <tr>
      <th>19</th>
      <td>27</td>
      <td>167</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>




```python
ff.filter(like='a',axis=1) 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>alpha</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>beta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26</td>
      <td>three</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>four</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>go</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16</td>
      <td>roku</td>
    </tr>
    <tr>
      <th>6</th>
      <td>28</td>
      <td>seven</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>eigt</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>toka</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29</td>
      <td>eleven</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23</td>
      <td>twelve</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>j_3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>15</td>
      <td>j_4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>19</td>
      <td>15</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>sixteen</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>teen_7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>28</td>
      <td>teen_8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>adult</td>
    </tr>
    <tr>
      <th>18</th>
      <td>15</td>
      <td>james</td>
    </tr>
    <tr>
      <th>19</th>
      <td>27</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>



like = 문자열을 제공하여 해당 문자열이 열 이름에 포함된 열만 선택하도록 합니다.


```python
ff.filter(regex='[a-zA-Z]*$') 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>169</td>
      <td>alpha</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>181</td>
      <td>beta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26</td>
      <td>186</td>
      <td>three</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>174</td>
      <td>four</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>172</td>
      <td>go</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16</td>
      <td>168</td>
      <td>roku</td>
    </tr>
    <tr>
      <th>6</th>
      <td>28</td>
      <td>164</td>
      <td>seven</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>167</td>
      <td>eigt</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>171</td>
      <td>toka</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29</td>
      <td>161</td>
      <td>eleven</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23</td>
      <td>176</td>
      <td>twelve</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>162</td>
      <td>j_3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>15</td>
      <td>182</td>
      <td>j_4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>19</td>
      <td>178</td>
      <td>15</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>167</td>
      <td>sixteen</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>163</td>
      <td>teen_7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>28</td>
      <td>186</td>
      <td>teen_8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>176</td>
      <td>adult</td>
    </tr>
    <tr>
      <th>18</th>
      <td>15</td>
      <td>187</td>
      <td>james</td>
    </tr>
    <tr>
      <th>19</th>
      <td>27</td>
      <td>167</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>



regex 정규 표현석으로 행 인덱스를 선택하는 방법입니다.

### 행, 열 삭제 메서드 : drop
데이터프레임.drop('삭제할 행 번호', inplace=True)

3행의 말포이 데이터를 삭제 해보록 하겠습니다.


```python
potters.drop(3, inplace=True)
```


```python
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>class</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
      <td>94</td>
    </tr>
  </tbody>
</table>
</div>



이번에는 3열의 데이터를 삭제 해보록 하겠습니다.
이 경우, drop  뒤에 컬럼명을 입력하고, 축을 axis=1 로 지정하면 열별 데이터를 탐색 후 삭제 하게 됩니다.
grade 를 삭제 해보록 하겠습니다.


```python
potters.drop('grade',axis=1,inplace=True)
```


```python
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>harry</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lone</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>herm</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



인덱스 순서 변경 메서드
인덱스 순서를 변경 하고 싶을때는, 데이터 프레임= 데이터 프레임[[변경할 순서]] 형식으로 입력하면 됩니다.


```python
potters=potters[['class','name']]
potters
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>harry</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>lone</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>herm</td>
    </tr>
  </tbody>
</table>
</div>



##### 테이블 명 정렬 메서드. 컬럼의 인덱스화
- sort_values:
    -columns= 정렬할 컬럼명
    -ascending= 디폴트 트루값, false 일시 내림차순
- sort_index: 인덱스 번호에 따라 정렬하는 메서드
- reset_index: sort_index 를 해제하는 메서드
- set_index: 인덱스 번호 대신 인덱스가 될 컬럼을 인자값으로 받는 메서드


```python
uuf = pd.DataFrame({
    '이름': ['여름', '설아', '루다'],
    '국어': list(np.random.randint(40,90,size=3)),
    '영어': list(np.random.randint(40,100,size=3)),
    '수학': list(np.random.randint(40,80,size=3))
})
```


```python
print(uuf.sort_values('이름'))
print("-"*20)
print(uuf.sort_values('국어',ascending=False))
print("-"*20)
print(uuf.sort_values('영어'))
```

       이름  국어  영어  수학
    2  루다  54  86  56
    1  설아  65  61  58
    0  여름  55  49  59
    --------------------
       이름  국어  영어  수학
    1  설아  65  61  58
    0  여름  55  49  59
    2  루다  54  86  56
    --------------------
       이름  국어  영어  수학
    0  여름  55  49  59
    1  설아  65  61  58
    2  루다  54  86  56
    


```python
uuf.set_index('이름',inplace=True)
uuf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>영어</th>
      <th>수학</th>
    </tr>
    <tr>
      <th>이름</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>여름</th>
      <td>55</td>
      <td>49</td>
      <td>59</td>
    </tr>
    <tr>
      <th>설아</th>
      <td>65</td>
      <td>61</td>
      <td>58</td>
    </tr>
    <tr>
      <th>루다</th>
      <td>54</td>
      <td>86</td>
      <td>56</td>
    </tr>
  </tbody>
</table>
</div>




```python
uuf.sort_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>영어</th>
      <th>수학</th>
    </tr>
    <tr>
      <th>이름</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>루다</th>
      <td>54</td>
      <td>86</td>
      <td>56</td>
    </tr>
    <tr>
      <th>설아</th>
      <td>65</td>
      <td>61</td>
      <td>58</td>
    </tr>
    <tr>
      <th>여름</th>
      <td>55</td>
      <td>49</td>
      <td>59</td>
    </tr>
  </tbody>
</table>
</div>




```python
uuf.reset_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>영어</th>
      <th>수학</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>여름</td>
      <td>55</td>
      <td>49</td>
      <td>59</td>
    </tr>
    <tr>
      <th>1</th>
      <td>설아</td>
      <td>65</td>
      <td>61</td>
      <td>58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>루다</td>
      <td>54</td>
      <td>86</td>
      <td>56</td>
    </tr>
  </tbody>
</table>
</div>



## 2.1.4.전치, 행렬 곱, 사칙 연산 메서드


```python
df= pd.DataFrame()
df['국어 성적']=[34,78,65,56,92,100,21]
t=df.describe()
t
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어 성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>63.714286</td>
    </tr>
    <tr>
      <th>std</th>
      <td>29.124527</td>
    </tr>
    <tr>
      <th>min</th>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>65.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>85.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div>



전치 메서드: ,T
- 데이터프레임.T 를 입력하면, 행과 열을 바꾸어 나타내도록 합니다.


```python
t.T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>국어 성적</th>
      <td>7.0</td>
      <td>63.714286</td>
      <td>29.124527</td>
      <td>21.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>85.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div>



#### 데이터 프레임 + 데이터 프레임 = ???


```python
st1=pd.DataFrame({'선수':['제우스','오너','페이커','구마유시','케리아'],
             '라인':['탑','정글','미드','adc','서포터']})
st1['world_c']=[1,1,4,1,1]
st1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수</th>
      <th>라인</th>
      <th>world_c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>제우스</td>
      <td>탑</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>오너</td>
      <td>정글</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>페이커</td>
      <td>미드</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>구마유시</td>
      <td>adc</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>케리아</td>
      <td>서포터</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
skt15=[['마린','탑','1'],['뱅기','정글','2'],
                  ['페이커','미드','2'],['뱅','원딜','2'],
                  ['울프','서포터',None]]
skt15=pd.DataFrame(skt15,columns=['선수','라인','word_c'])
skt15
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수</th>
      <th>라인</th>
      <th>word_c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마린</td>
      <td>탑</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>뱅기</td>
      <td>정글</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>페이커</td>
      <td>미드</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>뱅</td>
      <td>원딜</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>울프</td>
      <td>서포터</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>



두개의 데이터 프레임을 그대로 더하는 경우, 데이터의 손실이 발생합니다.


```python
st1+skt15
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word_c</th>
      <th>world_c</th>
      <th>라인</th>
      <th>선수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>탑탑</td>
      <td>제우스마린</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>정글정글</td>
      <td>오너뱅기</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>미드미드</td>
      <td>페이커페이커</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>adc원딜</td>
      <td>구마유시뱅</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>서포터서포터</td>
      <td>케리아울프</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade={
    '통계':[50,75,67,82,56,78],
    '선대':[88,67,94,67,45,99],
    '미적분':[63,32,57,42,87,100]
}
bdf=pd.DataFrame(grade)
bdf['수강생']=['남주혁','우도환','이도현','이종석',
            '육성재','차은우']
```


```python
bdf=bdf[['수강생','선대','미적분','통계']]
```


```python
bdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88</td>
      <td>63</td>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67</td>
      <td>32</td>
      <td>75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94</td>
      <td>57</td>
      <td>67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67</td>
      <td>42</td>
      <td>82</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45</td>
      <td>87</td>
      <td>56</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99</td>
      <td>100</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div>



이번에는 난수를 추출해서 여학생 반의 점수를 만들어 보겠습니다.


```python
ggrade={'통계':list(np.random.randint(20, 100, size=6)),
        '선대':list(np.random.randint(20, 100, size=6)),
        '미적분':list(np.random.randint(20, 100, size=6)),
    '수강생':['카리나','신유나','카즈하','장원영','민지','김민주']}
```


```python
gdf=pd.DataFrame(ggrade)
gdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
    </tr>
    <tr>
      <th>3</th>
      <td>82</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
    </tr>
  </tbody>
</table>
</div>




```python
gdf+bdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>미적분</th>
      <th>선대</th>
      <th>수강생</th>
      <th>통계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147</td>
      <td>178</td>
      <td>카리나남주혁</td>
      <td>98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>114</td>
      <td>160</td>
      <td>신유나우도환</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2</th>
      <td>147</td>
      <td>172</td>
      <td>카즈하이도현</td>
      <td>140</td>
    </tr>
    <tr>
      <th>3</th>
      <td>96</td>
      <td>93</td>
      <td>장원영이종석</td>
      <td>164</td>
    </tr>
    <tr>
      <th>4</th>
      <td>161</td>
      <td>98</td>
      <td>민지육성재</td>
      <td>151</td>
    </tr>
    <tr>
      <th>5</th>
      <td>160</td>
      <td>122</td>
      <td>김민주차은우</td>
      <td>155</td>
    </tr>
  </tbody>
</table>
</div>



단순히 두 df 를 더하는 경우, 수치형은 더하고, 문자열은 이어 붙이는 형태로 데이터 프레임이 만들어집니다.

만약에 nan 값이 있는 경우는 어떨까요?


```python
gdf.loc[3,'통계']=None
```


```python
gdf+bdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>미적분</th>
      <th>선대</th>
      <th>수강생</th>
      <th>통계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147</td>
      <td>178</td>
      <td>카리나남주혁</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>114</td>
      <td>160</td>
      <td>신유나우도환</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>147</td>
      <td>172</td>
      <td>카즈하이도현</td>
      <td>140.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>96</td>
      <td>93</td>
      <td>장원영이종석</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>161</td>
      <td>98</td>
      <td>민지육성재</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>160</td>
      <td>122</td>
      <td>김민주차은우</td>
      <td>155.0</td>
    </tr>
  </tbody>
</table>
</div>



위와 같이 문자열 데이터는 서로 합쳐지고, 산술 데이터는 더하는데, 결측치가 있는 값은 nan 을 호출하게 됩니다.


```python
gdf.loc[3,'통계']=99
```

#### 사칙 연산


```python
print(gdf['선대']-gdf['미적분'])
print("#"*20)
print(gdf['선대']/gdf['미적분'])
print("#"*20)
print(gdf['선대']//ggrade['미적분']) #몫
print("#"*20)
print(gdf['선대']%gdf['미적분']) #나머지
# 다른 데이터 프레임의 값도 연산이 가능
```

    0     6
    1    11
    2   -12
    3   -28
    4   -21
    5   -37
    dtype: int32
    ####################
    0    1.071429
    1    1.134146
    2    0.866667
    3    0.481481
    4    0.716216
    5    0.383333
    dtype: float64
    ####################
    0    1
    1    1
    2    0
    3    0
    4    0
    5    0
    Name: 선대, dtype: int32
    ####################
    0     6
    1    11
    2    78
    3    26
    4    53
    5    23
    dtype: int32
    

### 위와 같이 컬럼 이름을 통한 사칙 연산이 가능합니다.

##### 평균 열 만들어 보기


```python
gdf['평균']=(gdf['미적분']+gdf['통계']+gdf['선대'])/3
gdf['평균']=gdf['평균'].round(1) # 만들어진 컬럼 전체에 round(1)을 사용해 반올림
gdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>73.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>80.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>59.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>53.3</td>
    </tr>
  </tbody>
</table>
</div>



### 2.2  데이터 리셰이핑 메서드

#### 2.2.1 melt 메서드

'melt' 함수는 데이터 프레임을 재 구조화 하는데 사용 되며, 주로 넒은 형식의 데이터를 긴 형식으로 변환하는데 사용됩니다. 'melt' 함수를 사용하면 열을 행으로 변환하여 데이터를 정돈 할 수 있습니다. 
melt의 파라미터들은 다음과 같습니다.
- dataframe= : 긴 형식으로 변환할 데이터 프레임입니다. 이 값은 반드시 입력해야 하는 값입니다.
- id_vars= : 유지하려는 열입니다. 명시하지 않을시, 모든 열이 유지되고 나머지 열들이 variable과 value 로 변환됩니다.
- value_vars= 병합될 열입니다. 명시하지 않으면, 나머지 모든 열이 대상이 됩니다.


```python
uuf = pd.DataFrame({
    '이름': ['여름', '설아', '루다'],
    '국어': list(np.random.randint(40,90,size=3)),
    '영어': list(np.random.randint(40,100,size=3)),
    '수학': list(np.random.randint(40,80,size=3))
})
```


```python
uuf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>영어</th>
      <th>수학</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>여름</td>
      <td>77</td>
      <td>60</td>
      <td>76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>설아</td>
      <td>67</td>
      <td>96</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>루다</td>
      <td>40</td>
      <td>46</td>
      <td>57</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.melt(uuf,id_vars=['이름']
        ,value_vars=['국어','영어','수학'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>여름</td>
      <td>국어</td>
      <td>77</td>
    </tr>
    <tr>
      <th>1</th>
      <td>설아</td>
      <td>국어</td>
      <td>67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>루다</td>
      <td>국어</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>여름</td>
      <td>영어</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>설아</td>
      <td>영어</td>
      <td>96</td>
    </tr>
    <tr>
      <th>5</th>
      <td>루다</td>
      <td>영어</td>
      <td>46</td>
    </tr>
    <tr>
      <th>6</th>
      <td>여름</td>
      <td>수학</td>
      <td>76</td>
    </tr>
    <tr>
      <th>7</th>
      <td>설아</td>
      <td>수학</td>
      <td>56</td>
    </tr>
    <tr>
      <th>8</th>
      <td>루다</td>
      <td>수학</td>
      <td>57</td>
    </tr>
  </tbody>
</table>
</div>



### 2.2.2 concat  메서드

두 개 이상이 데이터 프레임을 행 또는 열 기준으로 결합 하는데 사용 되는 함수입니다. concat 함수를 사용하면 데이터 프레임을 수직으로 위 아래 또는 수평, 좌 우로 결합 할 수 있습니다.


```python
concat_df= pd.concat([gdf,bdf])
concat_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>73.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>80.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>59.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>53.3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



위에서 보는 바와 같이, bdf 에 존재 하지 않는 열 데이터는 Nan으로 표기됩니다.


```python
verti_d=pd.concat([gdf,bdf],axis=1)
verti_d
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>평균</th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>74.0</td>
      <td>남주혁</td>
      <td>88</td>
      <td>63</td>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>73.7</td>
      <td>우도환</td>
      <td>67</td>
      <td>32</td>
      <td>75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>80.3</td>
      <td>이도현</td>
      <td>94</td>
      <td>57</td>
      <td>67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>59.7</td>
      <td>이종석</td>
      <td>67</td>
      <td>42</td>
      <td>82</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>74.0</td>
      <td>육성재</td>
      <td>45</td>
      <td>87</td>
      <td>56</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>53.3</td>
      <td>차은우</td>
      <td>99</td>
      <td>100</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div>



위와같이 concat의 내부인자 axis= 1 로 설정하면, 두 데이터 프레임을 수평으로 결합합니다.

ignore_index

- ignore_index 값을 True 로 입력하면, 기존의 인덱스 값을 무시하고 새롭게 0에서부터 인덱싱을 다시 시작합니다.


```python
concat_df= pd.concat([gdf,bdf], ignore_index=True)
concat_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>73.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>80.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>59.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>53.3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



#### concat 파라미터: join


```python
gdf['평균']=(gdf['통계']+gdf['선대']+gdf['미적분'])/3
```


```python
gdf['평균']=gdf['평균'].round(1)
gdf=gdf[['수강생','통계','선대','미적분','평균']]
gdf.sort_values('평균',ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>카즈하</td>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>80.3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>카리나</td>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>민지</td>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>신유나</td>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>73.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>장원영</td>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>59.7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김민주</td>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>53.3</td>
    </tr>
  </tbody>
</table>
</div>




```python
data={
    '수강생':['카즈하','카리나','민지','신유나','장원영','황예지'],
    '해석학':[None,54,66,44,32,99],
    '확률론':[77,46,88,None,None,96]
}
gdf2= pd.DataFrame(data)
gdf2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>NaN</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>



위에서 보는 것과 같이 gdf와 gdf2 는 각각 행과 열이 다소 다른 데이터 프레임입니다.


```python
iner_con=pd.concat([gdf,gdf2],join='inner',axis=1)
iner_con
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>평균</th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카리나</td>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>74.0</td>
      <td>카즈하</td>
      <td>NaN</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>신유나</td>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>73.7</td>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>카즈하</td>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>80.3</td>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>장원영</td>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>59.7</td>
      <td>신유나</td>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>민지</td>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>74.0</td>
      <td>장원영</td>
      <td>32.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김민주</td>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>53.3</td>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
out_con=pd.concat([gdf,gdf2],join='outer',axis=1)
out_con
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>평균</th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카리나</td>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>74.0</td>
      <td>카즈하</td>
      <td>NaN</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>신유나</td>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>73.7</td>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>카즈하</td>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>80.3</td>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>장원영</td>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>59.7</td>
      <td>신유나</td>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>민지</td>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>74.0</td>
      <td>장원영</td>
      <td>32.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김민주</td>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>53.3</td>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>



join 조건을 inner로 할시: 교집합인 데이터 부분만,
outer 조건일시: 합집합인 데이터 부분만 추출해 냅니다.

### 2.2.3pivot 메서드

pivot 이란? 어떤 계산을 하기 위해 선택된 행렬의 성분을 의미합니다. 'pivot' 메서드는 데이터 프레임에서 특정 열을 행 인덱스, 열 이름, 그리고 데이터 값으로 재구조화 하는 메서드입니다. 이는 데이터의 형태를 변형하여 더 직관적으로 분석하거나 시각화 할때 유용합니다. 특정 조건에 따라 데이터를 재 구조화하는 것으로 sql에서 셀렉트 쿼리를 사용하여 특정 조건의 데이터를 가져 오는 것과 유사합니다. pivot_table() 함수의 파라미터들은 다음과 같습니다.

- 행 인덱스 = index
- 열 인덱스 = columns
- 데이터 값 = values
- 집계합수 = aggfunc

gdf 에서 평균 열을 제거 후, 성별 열을 만들어 보겠습니다


```python
gdf.drop('평균', axis=1,inplace=True)
p_concat=pd.concat([gdf,bdf],ignore_index=True) #새로운 인덱싱
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
    </tr>
  </tbody>
</table>
</div>




```python
gen=[]
for x in range(12):
    if 0<=x<=5:
        gen.append('여')
    else:
        gen.append('남')
p_concat['성별']= gen
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
    </tr>
  </tbody>
</table>
</div>



피벗 데이블을 활용하기 위해  반 항목을 추가하였습니다.


```python
p_concat['반']=list(np.random.randint(1,4,size=12))
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
pivot_1 = pd.pivot_table(p_concat, #피벗팅 테이블
                        index='반',
                        columns='성별',
                        values='미적분',
                        )
pivot_1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>성별</th>
      <th>남</th>
      <th>여</th>
    </tr>
    <tr>
      <th>반</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>100.000000</td>
      <td>69.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60.000000</td>
      <td>77.333333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53.666667</td>
      <td>74.000000</td>
    </tr>
  </tbody>
</table>
</div>



집계함수 인자(aggfunc)에 어떤 값도 입력하지 않을 경우, 기본적으로 평균값을 반환하게 됩니다. 따라서 3개의 반의 남녀 학생의 평균 점수가 나타나게 됩니다.

**또한 최소 2개 이상의 범주형 자료 열과 1개 이상의 수치형 자료열이 있어야 pd.piviot_table 이 온전히 작동하게 됩니다.**


```python
pivot_2 = pd.pivot_table(p_concat,
                        index='반',
                        columns='성별',
                        values=['미적분','선대','통계'],
                        aggfunc=['mean','max','min'])
pivot_2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">mean</th>
      <th colspan="6" halign="left">max</th>
      <th colspan="6" halign="left">min</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">미적분</th>
      <th colspan="2" halign="left">선대</th>
      <th colspan="2" halign="left">통계</th>
      <th colspan="2" halign="left">미적분</th>
      <th colspan="2" halign="left">선대</th>
      <th colspan="2" halign="left">통계</th>
      <th colspan="2" halign="left">미적분</th>
      <th colspan="2" halign="left">선대</th>
      <th colspan="2" halign="left">통계</th>
    </tr>
    <tr>
      <th>성별</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
      <th>남</th>
      <th>여</th>
    </tr>
    <tr>
      <th>반</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>100.000000</td>
      <td>69.000000</td>
      <td>99.000000</td>
      <td>58.000000</td>
      <td>78.0</td>
      <td>73.500000</td>
      <td>100</td>
      <td>84</td>
      <td>99</td>
      <td>90</td>
      <td>78.0</td>
      <td>99.0</td>
      <td>100</td>
      <td>54</td>
      <td>99</td>
      <td>26</td>
      <td>78.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60.000000</td>
      <td>77.333333</td>
      <td>91.000000</td>
      <td>64.666667</td>
      <td>58.5</td>
      <td>65.333333</td>
      <td>63</td>
      <td>90</td>
      <td>94</td>
      <td>93</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>57</td>
      <td>60</td>
      <td>88</td>
      <td>23</td>
      <td>50.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53.666667</td>
      <td>74.000000</td>
      <td>59.666667</td>
      <td>53.000000</td>
      <td>71.0</td>
      <td>95.000000</td>
      <td>87</td>
      <td>74</td>
      <td>67</td>
      <td>53</td>
      <td>82.0</td>
      <td>95.0</td>
      <td>32</td>
      <td>74</td>
      <td>45</td>
      <td>53</td>
      <td>56.0</td>
      <td>95.0</td>
    </tr>
  </tbody>
</table>
</div>



반별 남, 녀의 평균, 최댓값, 최소값등이 조건에 나뉘어서 출력되게 됩니다.

### df.groupby() 메서드
- 범주형 테이블 열을 그룹화한 객체를 생성하는 메서드 입니다.


```python
grouped=p_concat.groupby(['반','성별']) #그룹화 객체
grouped
```




    <pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000203BBA25A50>



그룹화된 항목들의 수를 시리즈로 반환해 호출하는 함수
- size()


```python
grouped.size()
```




    반  성별
    1  남     1
       여     2
    2  남     2
       여     3
    3  남     3
       여     1
    dtype: int64




```python
grouped['선대'].agg('mean')
```




    반  성별
    1  남     99.000000
       여     58.000000
    2  남     91.000000
       여     64.666667
    3  남     59.666667
       여     53.000000
    Name: 선대, dtype: float64



agg 내부에 ''를 넣고 mean, max. std 등의 값을 입력해 결과를 볼 수 있습니다.


```python
#데이터를 n 행씩 위나 아래로 이동시키는 메서드
grouped.shift(1) 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46.0</td>
      <td>93.0</td>
      <td>82.0</td>
      <td>신유나</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48.0</td>
      <td>90.0</td>
      <td>84.0</td>
      <td>카리나</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>73.0</td>
      <td>78.0</td>
      <td>90.0</td>
      <td>카즈하</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>50.0</td>
      <td>88.0</td>
      <td>63.0</td>
      <td>남주혁</td>
    </tr>
    <tr>
      <th>9</th>
      <td>75.0</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>우도환</td>
    </tr>
    <tr>
      <th>10</th>
      <td>82.0</td>
      <td>67.0</td>
      <td>42.0</td>
      <td>이종석</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



#### 그룹의 값들에 순위를 메기는 함수: rank
- rank의 파라미터 method 의 인자들:
    - dense: 밀집된 순위를 의미하는데, 동일한 값을 가지는 항목들에 대해 중복 순위를 부여하지 않고, 중복된 값들 사이의 순위가 띄어지지 않도록 조절합니다
    - min,max: 각각 중복을 허락해서, 극소, 극대값에서부터 값을 탐지합니다.
    - pct=True: 백분위 순위를 변환합니다.


```python
grouped_byg=p_concat.groupby('성별')
```


```python
grouped_byg.rank(method='dense')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>반</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
grouped_byg.rank(method='min')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>반</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
grouped_byg.rank(pct=True).round(2) #퍼센티지로 변환
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>반</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.33</td>
      <td>0.83</td>
      <td>0.83</td>
      <td>0.83</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.17</td>
      <td>1.00</td>
      <td>0.67</td>
      <td>0.50</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.50</td>
      <td>0.67</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.00</td>
      <td>0.33</td>
      <td>0.17</td>
      <td>0.67</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.83</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.33</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.67</td>
      <td>0.17</td>
      <td>0.33</td>
      <td>0.17</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.17</td>
      <td>0.67</td>
      <td>0.67</td>
      <td>0.17</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.67</td>
      <td>0.42</td>
      <td>0.17</td>
      <td>0.33</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.50</td>
      <td>0.83</td>
      <td>0.50</td>
      <td>0.67</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.00</td>
      <td>0.42</td>
      <td>0.33</td>
      <td>0.83</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.33</td>
      <td>0.17</td>
      <td>0.83</td>
      <td>0.50</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.83</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.17</td>
    </tr>
  </tbody>
</table>
</div>



## 누적합, 누적 최대값, **누적곱 메서드**
이 중 누적 곱 메서드는 시계열 주가 데이터 같은 곳에서 누적 수익률을 반환하는 중요한 메서드 입니다



```python
grouped_byg[['선대','미적분']].cumsum()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선대</th>
      <th>미적분</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>90</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>183</td>
      <td>166</td>
    </tr>
    <tr>
      <th>2</th>
      <td>261</td>
      <td>256</td>
    </tr>
    <tr>
      <th>3</th>
      <td>287</td>
      <td>310</td>
    </tr>
    <tr>
      <th>4</th>
      <td>340</td>
      <td>384</td>
    </tr>
    <tr>
      <th>5</th>
      <td>363</td>
      <td>444</td>
    </tr>
    <tr>
      <th>6</th>
      <td>88</td>
      <td>63</td>
    </tr>
    <tr>
      <th>7</th>
      <td>155</td>
      <td>95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>249</td>
      <td>152</td>
    </tr>
    <tr>
      <th>9</th>
      <td>316</td>
      <td>194</td>
    </tr>
    <tr>
      <th>10</th>
      <td>361</td>
      <td>281</td>
    </tr>
    <tr>
      <th>11</th>
      <td>460</td>
      <td>381</td>
    </tr>
  </tbody>
</table>
</div>




```python
grouped_byg[['선대','미적분']].cummax()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선대</th>
      <th>미적분</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>90</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>90</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>90</td>
    </tr>
    <tr>
      <th>5</th>
      <td>93</td>
      <td>90</td>
    </tr>
    <tr>
      <th>6</th>
      <td>88</td>
      <td>63</td>
    </tr>
    <tr>
      <th>7</th>
      <td>88</td>
      <td>63</td>
    </tr>
    <tr>
      <th>8</th>
      <td>94</td>
      <td>63</td>
    </tr>
    <tr>
      <th>9</th>
      <td>94</td>
      <td>63</td>
    </tr>
    <tr>
      <th>10</th>
      <td>94</td>
      <td>87</td>
    </tr>
    <tr>
      <th>11</th>
      <td>99</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>




```python
grouped_byg[['선대','미적분']].cumprod()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선대</th>
      <th>미적분</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>90</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8370</td>
      <td>6888</td>
    </tr>
    <tr>
      <th>2</th>
      <td>652860</td>
      <td>619920</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16974360</td>
      <td>33475680</td>
    </tr>
    <tr>
      <th>4</th>
      <td>899641080</td>
      <td>2477200320</td>
    </tr>
    <tr>
      <th>5</th>
      <td>20691744840</td>
      <td>148632019200</td>
    </tr>
    <tr>
      <th>6</th>
      <td>88</td>
      <td>63</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5896</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>8</th>
      <td>554224</td>
      <td>114912</td>
    </tr>
    <tr>
      <th>9</th>
      <td>37133008</td>
      <td>4826304</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1670985360</td>
      <td>419888448</td>
    </tr>
    <tr>
      <th>11</th>
      <td>165427550640</td>
      <td>41988844800</td>
    </tr>
  </tbody>
</table>
</div>



## 데이터 프레임 병합 메서드: pd.merge()


```python
data2= {
    '수강생':['남주혁','우도환','이도현','육성재',
          '차은우','이종석','마동석'],
    '해석학':list(np.random.randint(20,80,size=7)),
    '확률론':list(np.random.randint(20,80,size=7))
}
bdf2=pd.DataFrame(data2)
bdf2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>육성재</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>차은우</td>
      <td>29</td>
      <td>64</td>
    </tr>
    <tr>
      <th>5</th>
      <td>이종석</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>6</th>
      <td>마동석</td>
      <td>37</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(bdf,bdf2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88</td>
      <td>63</td>
      <td>50</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67</td>
      <td>32</td>
      <td>75</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94</td>
      <td>57</td>
      <td>67</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67</td>
      <td>42</td>
      <td>82</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45</td>
      <td>87</td>
      <td>56</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99</td>
      <td>100</td>
      <td>78</td>
      <td>29</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div>



merge 는 각 데이터에 존재하는 고유값을 기준으로 병합할 때 사용합니다. 

pd. merge 의 파라미터를 확인해 보겠습니다.

- df_left : 왼쪽 df
- df_right : 오른쪽 df
- how : 병합 방식을 의미합니다.
    - inner: 교집합 방식
    - outer: 합집합 방식
    - left: 왼쪽 df 를 기준으로 씁니다. 오른쪽 df 에 해당 값이 없는 경우 결측치가 됩니다.
    - right: 위와 같은 방식의 오른쪽 버젼 입니다.
- on : on: 각각의 df 에서 키로 쓸 컬럼을 의미합니다. 지정하지 않으면, 컬럼명이 같은 컬럼이 기준이 됩니다.
    - lef_on:왼쪽 df 에서 키로 쓸 컬럼을 의미합니다.
    - right_on: 오른쪽  df 에서 키로 쓸 컬럼을 의미합니다.


```python
pd.merge(bdf,bdf2, how='outer')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88.0</td>
      <td>63.0</td>
      <td>50.0</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>75.0</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94.0</td>
      <td>57.0</td>
      <td>67.0</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67.0</td>
      <td>42.0</td>
      <td>82.0</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45.0</td>
      <td>87.0</td>
      <td>56.0</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99.0</td>
      <td>100.0</td>
      <td>78.0</td>
      <td>29</td>
      <td>64</td>
    </tr>
    <tr>
      <th>6</th>
      <td>마동석</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




```python
bdf['평균']=((bdf['선대']+bdf['미적분']+bdf['통계'])/3).round(2)
```

    C:\Users\zuise\AppData\Local\Temp\ipykernel_12768\2513503885.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      bdf['평균']=((bdf['선대']+bdf['미적분']+bdf['통계'])/3).round(2)
    


```python
bdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88</td>
      <td>63</td>
      <td>50</td>
      <td>67.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67</td>
      <td>32</td>
      <td>75</td>
      <td>58.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94</td>
      <td>57</td>
      <td>67</td>
      <td>72.67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67</td>
      <td>42</td>
      <td>82</td>
      <td>63.67</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45</td>
      <td>87</td>
      <td>56</td>
      <td>62.67</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99</td>
      <td>100</td>
      <td>78</td>
      <td>92.33</td>
    </tr>
  </tbody>
</table>
</div>



조인 방법 left 와 right 의 차이를 알아보기 위해 bdf2 에 존재하지 않는 평균 열을 추가하였습니다.


```python
merge_l= pd.merge(bdf,bdf2, how='left', on='수강생')
merge_l
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88</td>
      <td>63</td>
      <td>50</td>
      <td>67.00</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67</td>
      <td>32</td>
      <td>75</td>
      <td>58.00</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94</td>
      <td>57</td>
      <td>67</td>
      <td>72.67</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67</td>
      <td>42</td>
      <td>82</td>
      <td>63.67</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45</td>
      <td>87</td>
      <td>56</td>
      <td>62.67</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99</td>
      <td>100</td>
      <td>78</td>
      <td>92.33</td>
      <td>29</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div>




```python
merge_r= pd.merge(bdf,bdf2, how='right', on='수강생')
merge_r
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88.0</td>
      <td>63.0</td>
      <td>50.0</td>
      <td>67.00</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>75.0</td>
      <td>58.00</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94.0</td>
      <td>57.0</td>
      <td>67.0</td>
      <td>72.67</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>육성재</td>
      <td>45.0</td>
      <td>87.0</td>
      <td>56.0</td>
      <td>62.67</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>차은우</td>
      <td>99.0</td>
      <td>100.0</td>
      <td>78.0</td>
      <td>92.33</td>
      <td>29</td>
      <td>64</td>
    </tr>
    <tr>
      <th>5</th>
      <td>이종석</td>
      <td>67.0</td>
      <td>42.0</td>
      <td>82.0</td>
      <td>63.67</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>6</th>
      <td>마동석</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>



보는 바와 같이 left, right는 한 쪽 데이터 프레임을 기준으로 데이터를 병합하는데, 그 기준이 반대쪽 데이터 프레임에 존재하지 않으면 이를 nan 으로 반환하고 병합합니다.


```python
bdf2.rename(columns={'수강생':'학생'},inplace=True)
```


```python
bdf2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>학생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>육성재</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>차은우</td>
      <td>29</td>
      <td>64</td>
    </tr>
    <tr>
      <th>5</th>
      <td>이종석</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>6</th>
      <td>마동석</td>
      <td>37</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>



다음은 동일한 키 값을 가지고 있는데, 컬럼명이 다른 경우 입니다. 이 경우 left_on, right_on 에 각각의 컬럼 명을 입력하여 두 컬럼의 키가 동일함을 인식 시켜야 합니다.


```python
merge_difference_cname=pd.merge(bdf,bdf2,how='outer',left_on='수강생',right_on='학생')
merge_difference_cname
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
      <th>학생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>남주혁</td>
      <td>88.0</td>
      <td>63.0</td>
      <td>50.0</td>
      <td>67.00</td>
      <td>남주혁</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>우도환</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>75.0</td>
      <td>58.00</td>
      <td>우도환</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이도현</td>
      <td>94.0</td>
      <td>57.0</td>
      <td>67.0</td>
      <td>72.67</td>
      <td>이도현</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이종석</td>
      <td>67.0</td>
      <td>42.0</td>
      <td>82.0</td>
      <td>63.67</td>
      <td>이종석</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>육성재</td>
      <td>45.0</td>
      <td>87.0</td>
      <td>56.0</td>
      <td>62.67</td>
      <td>육성재</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>차은우</td>
      <td>99.0</td>
      <td>100.0</td>
      <td>78.0</td>
      <td>92.33</td>
      <td>차은우</td>
      <td>29</td>
      <td>64</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>마동석</td>
      <td>37</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




```python
merge_difference_cname=pd.merge(bdf,bdf2,how='outer')
```


    ---------------------------------------------------------------------------

    MergeError                                Traceback (most recent call last)

    Cell In[246], line 1
    ----> 1 merge_difference_cname=pd.merge(bdf,bdf2,how='outer')
    

    File ~\anaconda3\Lib\site-packages\pandas\core\reshape\merge.py:148, in merge(left, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator, validate)
        131 @Substitution("\nleft : DataFrame or named Series")
        132 @Appender(_merge_doc, indents=0)
        133 def merge(
       (...)
        146     validate: str | None = None,
        147 ) -> DataFrame:
    --> 148     op = _MergeOperation(
        149         left,
        150         right,
        151         how=how,
        152         on=on,
        153         left_on=left_on,
        154         right_on=right_on,
        155         left_index=left_index,
        156         right_index=right_index,
        157         sort=sort,
        158         suffixes=suffixes,
        159         indicator=indicator,
        160         validate=validate,
        161     )
        162     return op.get_result(copy=copy)
    

    File ~\anaconda3\Lib\site-packages\pandas\core\reshape\merge.py:719, in _MergeOperation.__init__(self, left, right, how, on, left_on, right_on, axis, left_index, right_index, sort, suffixes, indicator, validate)
        712     msg = (
        713         "Not allowed to merge between different levels. "
        714         f"({_left.columns.nlevels} levels on the left, "
        715         f"{_right.columns.nlevels} on the right)"
        716     )
        717     raise MergeError(msg)
    --> 719 self.left_on, self.right_on = self._validate_left_right_on(left_on, right_on)
        721 cross_col = None
        722 if self.how == "cross":
    

    File ~\anaconda3\Lib\site-packages\pandas\core\reshape\merge.py:1500, in _MergeOperation._validate_left_right_on(self, left_on, right_on)
       1498 common_cols = left_cols.intersection(right_cols)
       1499 if len(common_cols) == 0:
    -> 1500     raise MergeError(
       1501         "No common columns to perform merge on. "
       1502         f"Merge options: left_on={left_on}, "
       1503         f"right_on={right_on}, "
       1504         f"left_index={self.left_index}, "
       1505         f"right_index={self.right_index}"
       1506     )
       1507 if (
       1508     not left_cols.join(common_cols, how="inner").is_unique
       1509     or not right_cols.join(common_cols, how="inner").is_unique
       1510 ):
       1511     raise MergeError(f"Data columns not unique: {repr(common_cols)}")
    

    MergeError: No common columns to perform merge on. Merge options: left_on=None, right_on=None, left_index=False, right_index=False


on 조건을 입력하지 않은 경우, 이와 같은 예외를 발생합니다.

##### 병합 조건 3번째: left_index, right_index

left_index, right_index 는 bool 인자를 받는 파라미터로, 인덱스를 기준으로 병합을 수행하는데 사용됩니다.
이 경우, left_index=True 일시, 왼쪽 데이터 프레임의 인덱스를 기준으로, right는 오른쪽을 기준으로  병합을 수행합니다.
즉 다시 말해, 왼쪽 인덱스가 오른쪽 인덱스와 일치 하는 경우에만 해당 행을 합치라는 의미입니다.
둘다 true 값일 경우에는. 양쪽에서 모두 존재하는 인덱스에 한해서면 병합을 이루게 합니다.

### 데이터 병합 메서드 : join()

이 방법은 행 인덱스를 기준으로 병합한다는 점에서 merge 와는 차의점을 보입니다.


```python
bdf.set_index('수강생',inplace=True)
bdf2.set_index('학생',inplace=True)
```


```python
print(bdf)
print(bdf2)
```

         선대  미적분  통계     평균
    수강생                    
    남주혁  88   63  50  67.00
    우도환  67   32  75  58.00
    이도현  94   57  67  72.67
    이종석  67   42  82  63.67
    육성재  45   87  56  62.67
    차은우  99  100  78  92.33
         해석학  확률론
    학생           
    남주혁   61   79
    우도환   37   60
    이도현   36   55
    육성재   70   27
    차은우   29   64
    이종석   75   34
    마동석   37   27
    


```python
bdf.join(bdf2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
    <tr>
      <th>수강생</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>남주혁</th>
      <td>88</td>
      <td>63</td>
      <td>50</td>
      <td>67.00</td>
      <td>61</td>
      <td>79</td>
    </tr>
    <tr>
      <th>우도환</th>
      <td>67</td>
      <td>32</td>
      <td>75</td>
      <td>58.00</td>
      <td>37</td>
      <td>60</td>
    </tr>
    <tr>
      <th>이도현</th>
      <td>94</td>
      <td>57</td>
      <td>67</td>
      <td>72.67</td>
      <td>36</td>
      <td>55</td>
    </tr>
    <tr>
      <th>이종석</th>
      <td>67</td>
      <td>42</td>
      <td>82</td>
      <td>63.67</td>
      <td>75</td>
      <td>34</td>
    </tr>
    <tr>
      <th>육성재</th>
      <td>45</td>
      <td>87</td>
      <td>56</td>
      <td>62.67</td>
      <td>70</td>
      <td>27</td>
    </tr>
    <tr>
      <th>차은우</th>
      <td>99</td>
      <td>100</td>
      <td>78</td>
      <td>92.33</td>
      <td>29</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div>




```python
bdf2.join(bdf)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>해석학</th>
      <th>확률론</th>
      <th>선대</th>
      <th>미적분</th>
      <th>통계</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>학생</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>남주혁</th>
      <td>61</td>
      <td>79</td>
      <td>88.0</td>
      <td>63.0</td>
      <td>50.0</td>
      <td>67.00</td>
    </tr>
    <tr>
      <th>우도환</th>
      <td>37</td>
      <td>60</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>75.0</td>
      <td>58.00</td>
    </tr>
    <tr>
      <th>이도현</th>
      <td>36</td>
      <td>55</td>
      <td>94.0</td>
      <td>57.0</td>
      <td>67.0</td>
      <td>72.67</td>
    </tr>
    <tr>
      <th>육성재</th>
      <td>70</td>
      <td>27</td>
      <td>45.0</td>
      <td>87.0</td>
      <td>56.0</td>
      <td>62.67</td>
    </tr>
    <tr>
      <th>차은우</th>
      <td>29</td>
      <td>64</td>
      <td>99.0</td>
      <td>100.0</td>
      <td>78.0</td>
      <td>92.33</td>
    </tr>
    <tr>
      <th>이종석</th>
      <td>75</td>
      <td>34</td>
      <td>67.0</td>
      <td>42.0</td>
      <td>82.0</td>
      <td>63.67</td>
    </tr>
    <tr>
      <th>마동석</th>
      <td>37</td>
      <td>27</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



위와 같이 어떤 데이터 프레임을 주 데이터 프레임으로 지정하느냐에 따라 데이터가 달라집니다.

## 요약 정리 : 
- 동일한 열이 있을 때: concat(df,df2, axis=1) 로 병합하기
- 동일한 키(행) 이 있을때, merge, join 을 통해 병합하돼, 병합될 키를 확인하기.

## Final. etc : 데이터 프레임의 수치형 데이터를 범주화하기/ 결측치의 처리, csv파일로 내보내기.


```python
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



위의 p_concat의 평균 점수를 평균 점수 대로 변경 해 보도록 하겠습니다.


```python
p_concat['평균']=(p_concat['통계']+p_concat['선대']+p_concat['미적분'])/3
```


```python
p_concat['평균']=p_concat['평균'].round(2)
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
    </tr>
  </tbody>
</table>
</div>



수치형 데이터를 범주화 시키려면, pd.cut 메서드를 사용합니다.

pd.cut : 수치형 데이터를 구간별로 나누는 메서드
- cut 의 인자:
    - 데이터프레임: 구간화를 할 데이터 프레임
    - bins : 계층화 메서드
        - 정수 값을 입력하면 수치형 배열을 정수 값만큼만 계산하여 등분
        - 배열을 입력하면 배열 사이의 간격만큼 등분
    - labels: 계층화 라벨
        - 각 계층마다 이름을 입력함.

구간을 직접 명시하지 않고 bins 인자에 정수 값을 입력하면 그 입력 값만 데이터를 등분합니다.


```python
cut=pd.cut(p_concat['평균'],bins=3)
#구간화 시리즈 객체 생성
```


```python
type(cut)
cut
```




    0      (66.33, 79.33]
    1      (66.33, 79.33]
    2      (79.33, 92.33]
    3     (53.291, 66.33]
    4      (66.33, 79.33]
    5     (53.291, 66.33]
    6      (66.33, 79.33]
    7     (53.291, 66.33]
    8      (66.33, 79.33]
    9     (53.291, 66.33]
    10    (53.291, 66.33]
    11     (79.33, 92.33]
    Name: 평균, dtype: category
    Categories (3, interval[float64, right]): [(53.291, 66.33] < (66.33, 79.33] < (79.33, 92.33]]



생성된 객체에 describe() 를 입력하면 데이터 개수와 상대 도수를 반환합니다.


```python
cut.describe() 
```




    count                  12
    unique                  3
    top       (53.291, 66.33]
    freq                    5
    Name: 평균, dtype: object



평균 점수의 '평균'을 기준으로 1표준편차를 간격으로 하여 5구간으로 나누어 보겠습니다.


```python
mean=p_concat['평균'].mean()
std=p_concat['평균'].std()
print((mean,std))
```

    (69.27833333333332, 10.800174942466386)
    


```python
lst=[]
for x in range(-2,3):
    y=mean+x*std
    lst.append(y)
```


```python
lst
```




    [47.67798344840055,
     58.47815839086694,
     69.27833333333332,
     80.0785082757997,
     90.87868321826609]



값이 너무 난잡하므로 map 함수를 통해 이 값을 반올림한 리스트를 만들겠습니다.


```python
bin=list(map(lambda x:round(x,2),lst))
```


```python
bin
```




    [47.68, 58.48, 69.28, 80.08, 90.88]



이제 만들어진 값을 기준으로 '점수 구간' 이라는 칼럼을 정의하겠습니다.


```python
p_concat['점수 구간']=pd.cut(p_concat['평균'], bins=bin)
```


```python
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
      <th>점수 구간</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
      <td>(80.08, 90.88]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
      <td>(47.68, 58.48]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
      <td>(47.68, 58.48]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



'차은우' 행이 정해진 범위 이상 값이라 nan 으로 표시 되었으므로, bin 의 마지막 값을 100 을 넣어 다시 표현 하겠습니다.


```python
bin[4]=100
bin[0]=0
```


```python
bin
```




    [0, 58.48, 69.28, 80.08, 100]




```python
p_concat['점수 구간']=pd.cut(p_concat['평균'], bins=bin)
```


```python
p_concat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
      <th>점수 구간</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
      <td>(80.08, 100.0]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
      <td>(0.0, 58.48]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
      <td>(0.0, 58.48]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
      <td>(69.28, 80.08]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
      <td>(58.48, 69.28]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
      <td>(80.08, 100.0]</td>
    </tr>
  </tbody>
</table>
</div>



점수 구간을 이름을 정해 등급화 하기


```python
p_concat['평점']=pd.cut(p_concat['평균'], bins=bin,
                     labels=['D','C','B','A'])
```


```python
p_concat.drop('등수',axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
      <th>점수 구간</th>
      <th>평점</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
    </tr>
    <tr>
      <th>7</th>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
    </tr>
    <tr>
      <th>8</th>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
    </tr>
    <tr>
      <th>9</th>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
    </tr>
    <tr>
      <th>10</th>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
    </tr>
    <tr>
      <th>11</th>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>



만들어진 데이터 프레임을 csv,excel 로 보내기

to_csv, to_excel 을 이용하면 이 파일들을 작업공간에 csv,excel 파일로 전송할 수 있습니다.


```python
p_concat.to_csv('최종성적표.csv')
```


```python
grade=pd.read_csv('최종성적표.csv')
```


```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
      <th>점수 구간</th>
      <th>평점</th>
      <th>등수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.set_index('Unnamed: 0')
grade.rename(columns={'Unnamed: 0':'인덱스 번호'},inplace=True)
```


```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인덱스 번호</th>
      <th>통계</th>
      <th>선대</th>
      <th>미적분</th>
      <th>수강생</th>
      <th>성별</th>
      <th>반</th>
      <th>평균</th>
      <th>점수 구간</th>
      <th>평점</th>
      <th>등수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>48.0</td>
      <td>90</td>
      <td>84</td>
      <td>카리나</td>
      <td>여</td>
      <td>1</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>46.0</td>
      <td>93</td>
      <td>82</td>
      <td>신유나</td>
      <td>여</td>
      <td>2</td>
      <td>73.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>73.0</td>
      <td>78</td>
      <td>90</td>
      <td>카즈하</td>
      <td>여</td>
      <td>2</td>
      <td>80.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>99.0</td>
      <td>26</td>
      <td>54</td>
      <td>장원영</td>
      <td>여</td>
      <td>1</td>
      <td>59.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>95.0</td>
      <td>53</td>
      <td>74</td>
      <td>민지</td>
      <td>여</td>
      <td>3</td>
      <td>74.00</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>77.0</td>
      <td>23</td>
      <td>60</td>
      <td>김민주</td>
      <td>여</td>
      <td>2</td>
      <td>53.33</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>50.0</td>
      <td>88</td>
      <td>63</td>
      <td>남주혁</td>
      <td>남</td>
      <td>2</td>
      <td>67.00</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>75.0</td>
      <td>67</td>
      <td>32</td>
      <td>우도환</td>
      <td>남</td>
      <td>3</td>
      <td>58.00</td>
      <td>(0.0, 58.48]</td>
      <td>D</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>67.0</td>
      <td>94</td>
      <td>57</td>
      <td>이도현</td>
      <td>남</td>
      <td>2</td>
      <td>72.67</td>
      <td>(69.28, 80.08]</td>
      <td>B</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>82.0</td>
      <td>67</td>
      <td>42</td>
      <td>이종석</td>
      <td>남</td>
      <td>3</td>
      <td>63.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>56.0</td>
      <td>45</td>
      <td>87</td>
      <td>육성재</td>
      <td>남</td>
      <td>3</td>
      <td>62.67</td>
      <td>(58.48, 69.28]</td>
      <td>C</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>78.0</td>
      <td>99</td>
      <td>100</td>
      <td>차은우</td>
      <td>남</td>
      <td>1</td>
      <td>92.33</td>
      <td>(80.08, 100.0]</td>
      <td>A</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>



결측치 처리


```python
gdf2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>NaN</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>



gdf2 같은 경우 결측치가 많이 존재하는 데이터 프레임입니다. 


```python
print(gdf2.isnull().sum())
print(gdf2.isnull())
```

    수강생    0
    해석학    1
    확률론    2
    dtype: int64
         수강생    해석학    확률론
    0  False   True  False
    1  False  False  False
    2  False  False  False
    3  False  False   True
    4  False  False   True
    5  False  False  False
    

isnull 의 경우 어디에 결측치가 존재하는지,
isnull.sum 의 경우 어느 열에 결측치가 존재하는지를 열별 합계를 내 반환합니다.


```python
import copy
gdf3=copy.deepcopy(gdf2)
```

결측치 대처 메소드 1. dropna()


```python
gdf3.dropna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>



    # 위와 같이 dropna 는 결측치 행을 삭제합니다.


```python
gdf3.dropna(axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
    </tr>
  </tbody>
</table>
</div>



dropna 에 axis=1 을 지정하면, 결측치 열을 삭제합니다.

결측치를 함부로 삭제하는 것은 데이터를 정제하는데 위험을 가져올수 잇으므로,
fillna 기법을 사용해 결측치를 다른 값으로 대체하는 게 좋습니다.


```python
gdf3.fillna(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>3.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
gdf3.fillna(method='ffill') # 이 경우 결측치를 결측 값의 앞 행으로 대체합니다. 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>NaN</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
gdf3.fillna(method='bfill') # 이 경우 결측치를 결측 값의 뒷 행으로 대체합니다. 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>54.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>96.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>96.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
gdf3.fillna(gdf3.iloc[:,1:].mean()) #이 경우 결측치를 각 열의 평균 값으로 대체하였습니다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>수강생</th>
      <th>해석학</th>
      <th>확률론</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>카즈하</td>
      <td>59.0</td>
      <td>77.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>카리나</td>
      <td>54.0</td>
      <td>46.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>민지</td>
      <td>66.0</td>
      <td>88.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>신유나</td>
      <td>44.0</td>
      <td>76.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>장원영</td>
      <td>32.0</td>
      <td>76.75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>황예지</td>
      <td>99.0</td>
      <td>96.00</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
